<div class="content">
  <div class="box">
    <%= simple_form_for(resource, :as => resource_name, :url => registration_path(resource_name), :html => { :method => :put, :enctype =>  "multipart/form-data" }) do |f| %>
      <% if params[:by].blank? %>
        <%= render "shared/error_messages", :target => resource %> 
      <% end %>
      <fieldset>
        <legend><%= t("users.personal_information")%></legend>
        <%= f.input :login %>
        <%= f.input :avatar %>
        <%= f.input :email, :input_html => { :class => "span6" } %>
        <%= f.input :location, :input_html => { :class => "span3" } %>
        <%= f.input :website, :input_html => { :class => "span6", :placeholder => "http://" } %>
        <%= f.input :tagline, :input_html => { :class => "span6" } %>
        <%= f.input :bio, :as => :text, :input_html => { :class => "span6", :rows => "6" } %>
        <div class="form-actions">
            <%= f.submit "更新资料", :class => "btn btn-primary", :disable_with => t("common.saving") %>
        </div>
      </fieldset>
    <% end %>
  </div>
  <% if Setting.registerable %>
    <div class="box">
      <%= simple_form_for(resource, :as => resource_name, :url => registration_path(resource_name,:by => :pwd), :html => { :method => :put }) do |f| %>
        <% if params[:by] == "pwd" %>
          <%= render "shared/error_messages", :target => resource %>
        <% end %>
        <fieldset>
          <legend><%= t("users.edit_password")%></legend>
          <input type="hidden" name="user[:by]" value="pwd" />
          <%= f.input :current_password %>
          <%= f.input :password %>
          <%= f.input :password_confirmation %>   
          <div class="form-actions">
            <%= f.submit "修改密码", :class => "btn btn-success", :disable_with => t("common.saving") %>
          </div>
        </fieldset>
      <% end %>
    </div>
  <% end %>
</div>

<div class="sidebar">
  <div class="box">
    <h2><%= t("users.bind_another_account")%></h2>
    <ul>
      <% ['weibo', 'douban'].each do |provider| %>
      <li>
        <% if @user.bind? provider %>
          <%= link_to( provider.titleize, "/account/auth/#{provider}/unbind", :rel => "twitsy", :title => "点击解除绑定" )%>
          <span class="label success">已绑定</span>
        <% else %>
          <%= link_to(provider.titleize, "/account/auth/#{provider}",:rel => "twitsy", :title => "点击解除绑定" )%>
        <% end %>
      </li>
      <% end %>
    </ul>
  </div>
  <div class="box">
    <h2><%= t("users.delete_my_account")%></h2>
    <p><%= t("users.dont_like_it")%> <%= link_to(t("users.delete_this_account"), registration_path(resource_name), :confirm => "删除后无法恢复，你确定吗?", :class => "btn btn-danger", :method => :delete )%></p>
  </div>
</div>
